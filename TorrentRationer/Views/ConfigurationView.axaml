<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:TorrentRationer.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="700"
             x:Class="TorrentRationer.Views.ConfigurationView"
             x:DataType="vm:ConfigurationViewModel">

    <ScrollViewer>
        <StackPanel Margin="20" Spacing="15">
            <TextBlock Text="Configuration" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>

            <!-- Upload Rate Settings -->
            <Border BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="2" 
                    CornerRadius="8" 
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Upload Rate Settings" FontSize="16" FontWeight="Bold"/>
                    
                    <Grid ColumnDefinitions="200,*" RowDefinitions="Auto,Auto">
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Minimum Upload Rate (KB/s):" VerticalAlignment="Center" Margin="0,0,0,10"/>
                        <NumericUpDown Grid.Row="0" Grid.Column="1" 
                                       Value="{Binding MinUploadRate}" 
                                       Minimum="0" 
                                       Maximum="10000"
                                       Width="200"
                                       HorizontalAlignment="Left"
                                       Margin="0,0,0,10"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Maximum Upload Rate (KB/s):" VerticalAlignment="Center"/>
                        <NumericUpDown Grid.Row="1" Grid.Column="1" 
                                       Value="{Binding MaxUploadRate}" 
                                       Minimum="0" 
                                       Maximum="100000"
                                       Width="200"
                                       HorizontalAlignment="Left"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Client and Seeding Settings -->
            <Border BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="2" 
                    CornerRadius="8" 
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Client and Seeding Settings" FontSize="16" FontWeight="Bold"/>
                    
                    <Grid ColumnDefinitions="200,*" RowDefinitions="Auto,Auto,Auto">
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Torrent Client:" VerticalAlignment="Center" Margin="0,0,0,10"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" 
                                  SelectedItem="{Binding TorrentClient}"
                                  Width="300"
                                  HorizontalAlignment="Left"
                                  Margin="0,0,0,10">
                            <ComboBoxItem Content="qBittorrent-4.5.0"/>
                            <ComboBoxItem Content="qBittorrent-4.4.5"/>
                            <ComboBoxItem Content="Transmission-3.00"/>
                            <ComboBoxItem Content="Deluge-2.0.3"/>
                            <ComboBoxItem Content="uTorrent-3.5.5"/>
                        </ComboBox>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Simultaneous Seeds:" VerticalAlignment="Center" Margin="0,0,0,10"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
                            <Slider Value="{Binding SimultaneousSeeds}" 
                                    Minimum="1" 
                                    Maximum="20"
                                    Width="300"
                                    TickFrequency="1"
                                    IsSnapToTickEnabled="True"/>
                            <TextBlock Text="{Binding SimultaneousSeeds}" 
                                       VerticalAlignment="Center"
                                       MinWidth="30"/>
                        </StackPanel>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Upload Ratio Target:" VerticalAlignment="Center"/>
                        <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Spacing="10">
                            <NumericUpDown Value="{Binding UploadRatioTarget}" 
                                          Minimum="-1" 
                                          Maximum="100"
                                          FormatString="F2"
                                          Width="200"
                                          HorizontalAlignment="Left"/>
                            <TextBlock Text="(-1 for infinite)" 
                                       VerticalAlignment="Center"
                                       Opacity="0.7"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Advanced Settings -->
            <Border BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="2" 
                    CornerRadius="8" 
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Advanced Settings" FontSize="16" FontWeight="Bold"/>
                    
                    <CheckBox Content="Keep seeding torrents even with no peers" 
                              IsChecked="{Binding KeepSeedingWithNoPeers}"/>
                    
                    <CheckBox Content="Auto-start with Windows" 
                              IsChecked="{Binding AutoStartWithWindows}"/>
                    
                    <CheckBox Content="Dark Mode" 
                              IsChecked="{Binding DarkMode}"/>
                </StackPanel>
            </Border>

            <!-- Torrent Path Settings -->
            <Border BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="2" 
                    CornerRadius="8" 
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Torrent Files Path" FontSize="16" FontWeight="Bold"/>
                    
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBox Grid.Column="0" 
                                 Text="{Binding DefaultTorrentPath}" 
                                 Watermark="Select default path for .torrent files"
                                 Margin="0,0,10,0"/>
                        <Button Grid.Column="1" 
                                Content="Browse..." 
                                Command="{Binding BrowseTorrentPathCommand}"
                                Width="100"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Tracker Management -->
            <Border BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="2" 
                    CornerRadius="8" 
                    Padding="15">
                <StackPanel Spacing="10">
                    <TextBlock Text="Tracker Management" FontSize="16" FontWeight="Bold"/>
                    <TextBlock Text="Configure trackers with 0 KB/s seeding to avoid Hit &amp; Run while maintaining presence" 
                               TextWrapping="Wrap"
                               Opacity="0.7"
                               FontSize="12"/>
                    
                    <Button Content="Add Tracker" 
                            Command="{Binding AddTrackerCommand}"
                            HorizontalAlignment="Left"
                            Margin="0,5,0,10"/>
                    
                    <DataGrid ItemsSource="{Binding Trackers}"
                              AutoGenerateColumns="False"
                              CanUserReorderColumns="True"
                              CanUserResizeColumns="True"
                              GridLinesVisibility="All"
                              BorderThickness="1"
                              MinHeight="200"
                              MaxHeight="300">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive}" Width="60" />
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" />
                            <DataGridTextColumn Header="URL" Binding="{Binding Url}" Width="2*" />
                            <DataGridCheckBoxColumn Header="0 KB/s Seeding" Binding="{Binding ZeroKbSeeding}" Width="120" />
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <!-- Save Button -->
            <Button Content="Save Configuration" 
                    Command="{Binding SaveCommand}"
                    HorizontalAlignment="Center"
                    Width="200"
                    Height="40"
                    FontSize="14"
                    FontWeight="Bold"
                    Margin="0,20,0,0"/>
        </StackPanel>
    </ScrollViewer>
</UserControl>
